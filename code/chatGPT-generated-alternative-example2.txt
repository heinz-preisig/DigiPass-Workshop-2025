@prefix ex:    <http://example.com/> .
@prefix sh:    <http://www.w3.org/ns/shacl#> .
@prefix dash:  <http://datashapes.org/dash#> .
@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .

ex:PersonShape
    a sh:NodeShape ;
    sh:targetClass ex:Person ;
    sh:name "Person shape" ;
    sh:description "Choose which SSN to provide." ;

    # Dropdown to choose which SSN to fill
    sh:property [
        sh:path ex:ssnChoice ;
        sh:name "Select SSN type" ;
        sh:description "Select which SSN you want to provide" ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        dash:editor dash:DropdownEditor ;
        dash:options (
            [ dash:label "SSN Type 1" ; dash:value "ssn1" ]
            [ dash:label "SSN Type 2" ; dash:value "ssn2" ]
        ) ;
    ] ;

    # Group for the conditional SSN input
    dash:group [
        a dash:PropertyGroup ;
        dash:groupName "SSN Information" ;
        dash:properties (
            # SSN Type 1 field
            [
                sh:path ex:ssn1 ;
                sh:name "SSN Type 1" ;
                sh:description "First SSN option" ;
                sh:datatype xsd:string ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                dash:editor dash:TextFieldEditor ;
                dash:singleLine true ;
                dash:showConditions (
                    [
                        a dash:ConditionalShape ;
                        dash:condition [
                            sh:path ex:ssnChoice ;
                            sh:hasValue "ssn1" ;
                        ]
                    ]
                ) ;
            ]
            # SSN Type 2 field
            [
                sh:path ex:ssn2 ;
                sh:name "SSN Type 2" ;
                sh:description "Second SSN option" ;
                sh:datatype xsd:string ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                dash:editor dash:TextFieldEditor ;
                dash:singleLine true ;
                dash:showConditions (
                    [
                        a dash:ConditionalShape ;
                        dash:condition [
                            sh:path ex:ssnChoice ;
                            sh:hasValue "ssn2" ;
                        ]
                    ]
                ) ;
            ]
        )
    ] ;

    # Validation: exactly one SSN must be filled
    sh:xone (
        [ sh:property [ sh:path ex:ssn1 ; sh:minCount 1 ] ]
        [ sh:property [ sh:path ex:ssn2 ; sh:minCount 1 ] ]
    ) .
